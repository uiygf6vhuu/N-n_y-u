<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Admin ğŸ’»</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ”‘ Trang Admin</h1>

    <div id="loginBox">
      <input type="password" id="password" placeholder="Nháº­p máº­t kháº©u" class="date-input">
      <button onclick="login()" class="btn">ÄÄƒng nháº­p</button>
    </div>

    <div id="adminBox" style="display:none;">
      <h2>ğŸ“· Upload áº£nh</h2>
      <input type="file" id="imageFile">
      <button onclick="uploadImage()" class="btn">Táº£i áº£nh</button>

      <h2>ğŸ’Œ ThÃªm tin nháº¯n</h2>
      <textarea id="adminMessage" placeholder="Nháº­p tin nháº¯n..." class="message-input"></textarea>
      <button onclick="addMessage()" class="btn">LÆ°u tin nháº¯n</button>
      <ul id="adminList" class="message-list"></ul>

      <a href="/" class="btn">Xem Trang NgÆ°á»i DÃ¹ng</a>
      <a href="/game.html" class="btn">ChÆ¡i Game</a>
    </div>
  </div>

<script>
async function login() {
  const password = document.getElementById('password').value;
  const res = await fetch('/api/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ password })
  });
  if (res.ok) {
    document.getElementById('loginBox').style.display = 'none';
    document.getElementById('adminBox').style.display = 'block';
    loadMessages();
  } else {
    alert("Sai máº­t kháº©u!");
  }
}

async function addMessage() {
  const msg = document.getElementById('adminMessage').value;
  const res = await fetch('/api/love-messages', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ message: msg })
  });
  const data = await res.json();
  alert(data.message);
  loadMessages();
}

async function loadMessages() {
  const res = await fetch('/api/love-messages');
  const data = await res.json();
  const list = document.getElementById('adminList');
  list.innerHTML = '';
  data.messages.forEach(m => {
    const li = document.createElement('li');
    li.textContent = m;
    list.appendChild(li);
  });
}

async function uploadImage() {
  const file = document.getElementById('imageFile').files[0];
  if (!file) return alert("Chá»n áº£nh trÆ°á»›c!");
  const formData = new FormData();
  formData.append('image', file);
  const res = await fetch('/api/upload', { method: 'POST', body: formData });
  const data = await res.json();
  alert("ÄÃ£ upload áº£nh!");
}
</script>
</body>
</html>
