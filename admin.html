<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Admin ğŸ’»</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ”‘ Trang Admin</h1>

    <div id="loginBox">
      <input type="password" id="password" placeholder="Nháº­p máº­t kháº©u" class="date-input">
      <button onclick="login()" class="btn">ÄÄƒng nháº­p</button>
    </div>

    <div id="adminBox" style="display:none;">
      <h2>ğŸ“· Cáº­p nháº­t áº¢nh (DÃ¹ng URL)</h2>
      <input type="text" id="imageUrl" placeholder="DÃ¡n URL áº£nh vÃ o Ä‘Ã¢y (vÃ­ dá»¥: https://imgur.com/link.jpg)" class="date-input">
      <button onclick="uploadImage()" class="btn">LÆ°u URL áº¢nh</button>

      <h2>ğŸ’Œ ThÃªm tin nháº¯n</h2>
      <textarea id="adminMessage" placeholder="Nháº­p tin nháº¯n..." class="message-input"></textarea>
      <button onclick="addMessage()" class="btn">LÆ°u tin nháº¯n</button>
      <ul id="adminList" class="message-list"></ul>

      <a href="/" class="btn">Xem Trang NgÆ°á»i DÃ¹ng</a>
      <a href="game.html" class="btn">ChÆ¡i Game</a>
    </div>
  </div>

<script>
async function login() {
  const password = document.getElementById('password').value;
  const res = await fetch('/api/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ password })
  });
  if (res.ok) {
    document.getElementById('loginBox').style.display = 'none';
    document.getElementById('adminBox').style.display = 'block';
    loadMessages();
  } else {
    alert("Sai máº­t kháº©u!");
  }
}

async function addMessage() {
  const msg = document.getElementById('adminMessage').value;
  const res = await fetch('/api/love-messages', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ message: msg })
  });
  const data = await res.json();
  alert(data.message);
  document.getElementById('adminMessage').value = ''; // XÃ³a ná»™i dung
  loadMessages();
}

async function loadMessages() {
  const res = await fetch('/api/love-messages');
  const data = await res.json();
  const list = document.getElementById('adminList');
  list.innerHTML = '';
  data.messages.forEach(m => {
    const li = document.createElement('li');
    li.textContent = m;
    list.appendChild(li);
  });
}

// Sá»¬A: HÃ m upload áº£nh má»›i, gá»­i URL lÃªn server
async function uploadImage() {
  const imageUrl = document.getElementById('imageUrl').value;
  if (!imageUrl.trim()) return alert("Vui lÃ²ng dÃ¡n URL áº£nh!");

  const res = await fetch('/api/upload-url', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ imageUrl: imageUrl })
  });
  const data = await res.json();
  alert(data.message);
}
</script>
</body>
</html>
