<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Trang K·ª∑ Ni·ªám Ki·ªÉu 3 üíï</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* ========================================= */
        /* CSS CHUNG CHO TRANG K·ª∂ NI·ªÜM */
        /* ========================================= */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #ffdde1, #ffafbd);
            color: #8b0000;
            flex-direction: column;
        }

        .heart-page-container {
            padding: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 90%;
            width: 600px;
            margin: 20px;
        }

        /* H√¨nh tr√°i tim (m√¥ ph·ªèng b·∫±ng 3 kh·ªëi vu√¥ng xoay) */
        .heart-container {
            position: relative;
            width: 200px;
            height: 180px;
            margin: 40px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.5s ease-out;
            transform-origin: center;
        }

        .heart-border {
            position: absolute;
            width: 100px;
            height: 100px;
            background-color: transparent;
            border-radius: 50%;
            transform: rotate(-45deg);
            box-shadow: 0 0 0 5px var(--heart-color); /* S·ª≠ d·ª•ng bi·∫øn m√†u JS */
        }
        .heart-border:before, .heart-border:after {
            content: "";
            position: absolute;
            width: 100px;
            height: 100px;
            background-color: transparent;
            border-radius: 50%;
            box-shadow: 0 0 0 5px var(--heart-color);
        }
        .heart-border:before {
            top: -50px;
            left: 0;
        }
        .heart-border:after {
            left: 50px;
            top: 0;
        }

        /* ·∫¢nh b√™n trong */
        .slideshow-img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            z-index: 10;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            border: 3px solid white;
            transition: transform 0.5s;
        }

        /* ========================================= */
        /* ANIMATIONS (M·∫°nh m·∫Ω - STRONG) */
        /* ========================================= */
        @keyframes heart-beat-strong {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes img-pulse-strong {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); } /* ·∫¢nh thu ph√≥ng m·∫°nh */
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="mainContent" class="container heart-page-container">
    <h1>üíô Trang K·ª∑ Ni·ªám Ki·ªÉu 3: C·ªï ƒêi·ªÉn (T√≠m) üíô</h1>
    
    <div class="heart-container" id="mainHeartContainer">
        <div class="heart-border" id="heartBorder"></div> 
        
        <img id="loveImage" class="slideshow-img" style="display:none;" alt="·∫¢nh k·ª∑ ni·ªám">
        <p id="noImage" style="display:none; color: #dc143c; font-weight: bold;">Ch∆∞a c√≥ ·∫£nh n√†o ƒë∆∞·ª£c t·∫£i l√™n!</p>
    </div>

    <div class="navigation">
        <a href="index.html" class="btn">V·ªÅ Trang Ch√≠nh</a>
    </div>
</div>

<script>
    let sitePassword = localStorage.getItem('sitePassword');

    async function loadImages() {
        try {
            if (!sitePassword) {
                window.location.href = 'index.html';
                return;
            }

            const imgResponse = await fetch('/api/love-image', {
                headers: { 'Authorization': sitePassword }
            });

            const loveImage = document.getElementById('loveImage');
            const noImage = document.getElementById('noImage');

            if (imgResponse.ok) {
                const imgData = await imgResponse.json();

                if (imgData.image) {
                    loveImage.src = imgData.image;
                    loveImage.style.display = 'block';
                    noImage.style.display = 'none';
                } else {
                    loveImage.style.display = 'none';
                    noImage.textContent = 'Ch∆∞a c√≥ ·∫£nh n√†o ƒë∆∞·ª£c t·∫£i l√™n!';
                    noImage.style.display = 'block';
                }
            } else {
                console.error('L·ªói t·∫£i ·∫£nh:', imgResponse.statusText);
                loveImage.style.display = 'none';
                noImage.textContent = 'L·ªói t·∫£i ·∫£nh. Vui l√≤ng ki·ªÉm tra l·∫°i m·∫≠t kh·∫©u trang ch√≠nh.';
                noImage.style.display = 'block';
            }
        } catch (error) {
            console.error('L·ªói t·∫£i d·ªØ li·ªáu:', error);
            document.getElementById('noImage').textContent = 'L·ªói k·∫øt n·ªëi server.';
            document.getElementById('noImage').style.display = 'block';
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        
        // =========================================================
        // PH·∫¶N TH√äM CONSTS ƒê√É CH·ªàNH S·ª¨A
        // =========================================================
        const heartColor = '#9370db'; // M√†u t√≠m
        const heartAnimation = 'heart-beat-strong 1.3s infinite';
        const imageAnimation = 'img-pulse-strong 1.3s infinite'; 
        // ---------------------------------------------------------
        
        loadImages();

        // ·ª®ng d·ª•ng m√†u s·∫Øc v√†o bi·∫øn CSS
        document.documentElement.style.setProperty('--heart-color', heartColor);
        
        // ·ª®ng d·ª•ng Animation cho tr√°i tim v√† ·∫£nh
        document.getElementById('mainHeartContainer').style.animation = heartAnimation;
        document.getElementById('loveImage').style.animation = imageAnimation;
    });
</script>
</body>
</html>
